# AI 助手文檔記錄規範

## 🚨 必須遵守的規則

### 規則 1: 問題診斷和解決方案的記錄位置

**所有技術問題必須記錄在 `TROUBLESHOOTING.md` 中！**

```
✅ 正確：TROUBLESHOOTING.md
   └─ 詳細的錯誤信息
   └─ 診斷步驟
   └─ 原因分析
   └─ 解決方案（多個方案）
   └─ 測試驗證
   └─ 經驗教訓

❌ 錯誤：開發文件.md
   └─ 不要寫詳細的診斷過程
   └─ 不要寫完整的解決步驟
   └─ 不要複製大段技術內容
```

### 規則 2: 開發文件.md 的正確用法

**只記錄簡短摘要 + 引用**

```markdown
## YYYY-MM-DD 問題簡述 ✅

**問題**: 一句話描述問題
**解決方案**: 一句話描述解決方法
**結果**: 測試結果

📝 **完整記錄**: 詳見 `TROUBLESHOOTING.md § X.X`

**修復時間**: YYYY-MM-DD HH:MM
**狀態**: ✅ 完全解決
```

### 規則 3: 記錄流程

```
問題發生
    ↓
1. 搜尋 TROUBLESHOOTING.md（是否已有類似問題？）
    ↓
2. 診斷和解決
    ↓
3. 在 TROUBLESHOOTING.md 新增或更新章節
   - 使用問題記錄模板
   - 包含完整的診斷步驟
   - 包含所有嘗試過的方案
   - 包含測試結果
    ↓
4. 在開發文件.md 添加簡短摘要
   - 最多 5-10 行
   - 必須引用 TROUBLESHOOTING.md 章節號
    ↓
5. （可選）重大問題創建獨立 SUMMARY.md
```

---

## 📋 文檔職責明確劃分

### TROUBLESHOOTING.md
**用途**: 技術問題的完整診斷和解決手冊

**內容**:
- ✅ 錯誤信息（原文）
- ✅ 問題症狀描述
- ✅ 診斷步驟（Step 1, Step 2...）
- ✅ 原因分析（為什麼發生）
- ✅ 解決方案（方案1、方案2...）
- ✅ 實施步驟（詳細命令）
- ✅ 測試驗證（如何確認修復）
- ✅ 經驗教訓
- ✅ 相關資源鏈接

**章節結構**:
```
## 3. 資料庫相關問題
### 3.1 問題A
### 3.2 問題B
### 3.3 問題C
### 3.4 問題D ← 新問題在此添加
```

---

### 開發文件.md
**用途**: 開發日誌和進度追蹤

**內容**:
- ✅ 日期和簡短標題
- ✅ 一句話問題描述
- ✅ 一句話解決方案
- ✅ 測試結果摘要
- ✅ **引用** TROUBLESHOOTING.md 章節號
- ❌ 不要寫診斷步驟
- ❌ 不要寫完整代碼
- ❌ 不要寫詳細命令

**格式範例**:
```markdown
## 2025-11-02 數據庫連接池超時 ✅

**問題**: Prisma 連接池耗盡導致查詢失敗
**解決**: 優化連接池參數（5→20）+ 重試機制
**結果**: 連續測試成功率 10% → 100%

📝 詳見 `TROUBLESHOOTING.md § 3.4`

狀態: ✅ 已解決
```

---

### *_SUMMARY.md（可選）
**用途**: 重大問題的深度總結報告

**何時創建**:
- 問題非常複雜（耗時 > 2小時）
- 涉及多個系統組件
- 需要詳細的技術分析
- 適合作為案例學習

**內容**:
- ✅ 完整的問題背景
- ✅ 詳細的技術分析
- ✅ 對比表格和圖表
- ✅ 性能測試數據
- ✅ 最佳實踐建議

---

## ⚠️ 常見錯誤示例

### ❌ 錯誤示例 1: 在開發文件.md 寫詳細內容

```markdown
## 2025-11-02 問題修復

### 診斷步驟
1. 檢查後端日誌...
2. 測試網絡連接...
3. 分析錯誤代碼...

### 解決方案
修改 backend/src/xxx.ts:
```typescript
// 100行代碼...
```

修改 .env:
```env
DATABASE_URL=...
```

### 測試
執行以下命令...
```

**問題**: 這些內容應該在 TROUBLESHOOTING.md 中！

---

### ✅ 正確示例 1: 開發文件.md 簡潔引用

```markdown
## 2025-11-02 數據庫連接池優化 ✅

**問題**: 連接池超時導致 API 間歇性失敗
**解決**: 連接池參數優化 + 自動重試
**結果**: 測試成功率 100%

📝 完整記錄: `TROUBLESHOOTING.md § 3.4`

狀態: ✅ 已解決
```

---

### ❌ 錯誤示例 2: 沒有引用 TROUBLESHOOTING.md

```markdown
## 2025-11-02 修復完成

問題已經解決了，修改了配置和代碼。
```

**問題**: 
1. 其他人無法找到詳細信息
2. 沒有引用章節號
3. 無法追溯解決方案

---

### ✅ 正確示例 2: 必須包含引用

```markdown
## 2025-11-02 XXX問題修復 ✅

📝 詳見 `TROUBLESHOOTING.md § 3.4`

狀態: ✅ 已解決
```

---

## 🤖 AI 助手自我檢查清單

**在記錄任何問題解決方案之前，問自己：**

- [ ] 我是否正在寫診斷步驟？
  - → 是 = 應該寫在 TROUBLESHOOTING.md
  
- [ ] 我是否正在寫多個解決方案？
  - → 是 = 應該寫在 TROUBLESHOOTING.md
  
- [ ] 我是否正在寫詳細的命令或代碼？
  - → 是 = 應該寫在 TROUBLESHOOTING.md
  
- [ ] 我是否正在寫完整的測試步驟？
  - → 是 = 應該寫在 TROUBLESHOOTING.md
  
- [ ] 內容超過 20 行了嗎？
  - → 是 = 絕對應該寫在 TROUBLESHOOTING.md

**只有這些可以寫在開發文件.md：**
- [ ] 一句話問題描述 ✅
- [ ] 一句話解決方案 ✅
- [ ] 測試結果摘要 ✅
- [ ] 引用 TROUBLESHOOTING.md § X.X ✅

---

## 📝 快速模板

### 模板 A: TROUBLESHOOTING.md 新章節

```markdown
### X.X 問題簡短標題

**錯誤訊息**：
```
錯誤原文
```

**問題症狀**：
- 症狀1
- 症狀2

**診斷步驟**：
Step 1: ...
Step 2: ...

**解決方案**：
方案 1: ...
方案 2: ...

**測試驗證**：
```bash
測試命令
```

**經驗教訓**：
1. ...
2. ...

**記錄時間**: YYYY-MM-DD HH:MM
**狀態**: ✅ 已解決
```

### 模板 B: 開發文件.md 摘要

```markdown
## YYYY-MM-DD 問題標題 ✅

**問題**: 一句話
**解決**: 一句話
**結果**: 一句話

📝 詳見 `TROUBLESHOOTING.md § X.X`

狀態: ✅ 已解決
```

---

## 🎯 總結

| 要寫什麼 | 寫在哪裡 |
|---------|---------|
| 診斷步驟 | TROUBLESHOOTING.md |
| 錯誤信息 | TROUBLESHOOTING.md |
| 解決方案（詳細） | TROUBLESHOOTING.md |
| 代碼修改 | TROUBLESHOOTING.md |
| 測試命令 | TROUBLESHOOTING.md |
| 經驗教訓 | TROUBLESHOOTING.md |
| 日期和摘要 | 開發文件.md |
| 引用章節號 | 開發文件.md |
| 深度分析 | *_SUMMARY.md（可選） |

---

**記住**: 
- 📚 TROUBLESHOOTING.md = 完整手冊
- 📝 開發文件.md = 簡短日誌
- 📊 *_SUMMARY.md = 深度報告（可選）

**永遠不要在開發文件.md 中寫超過 20 行的技術內容！**

---

**此文檔創建時間**: 2025-11-02  
**目的**: 防止 AI 助手再次將詳細技術內容寫入開發文件.md  
**優先級**: 🔴 最高 - 每次記錄問題前必須閱讀！
