# 🧪 文章發布及回覆功能測試指南

## 快速開始

### 1. 啟動應用
```bash
cd frontend
npx expo start
```

### 2. 確認套件已安裝
```bash
npm install expo-image-picker @react-native-async-storage/async-storage
```

## 測試清單

### ✅ 文章發布功能測試

#### Test 1: 基本文章創建
- [ ] 導航到 CreatePost 頁面
- [ ] 輸入標題："我的第一篇文章"
- [ ] 輸入內容："這是測試內容..."
- [ ] 點擊 "發布" 按鈕
- [ ] 驗證：跳轉到首頁並顯示成功提示

#### Test 2: 圖片上傳
- [ ] 點擊 "添加圖片 (0/9)" 按鈕
- [ ] 從相冊選擇 2-3 張圖片
- [ ] 驗證：圖片預覽顯示（100x100）
- [ ] 點擊預覽圖上的 X 按鈕刪除一張
- [ ] 驗證：圖片被移除
- [ ] 嘗試上傳 9 張圖片
- [ ] 驗證：達到限制後按鈕禁用

#### Test 3: 標籤選擇
- [ ] 點擊 "添加標籤 (0/5)" 按鈕
- [ ] 從熱門標籤中選擇 2 個
- [ ] 驗證：標籤顯示在已選區域
- [ ] 輸入自定義標籤："測試標籤"
- [ ] 點擊 "添加" 按鈕
- [ ] 驗證：自定義標籤被添加
- [ ] 選擇第 4、5 個標籤
- [ ] 嘗試選擇第 6 個標籤
- [ ] 驗證：顯示 "最多只能選擇 5 個標籤"

#### Test 4: 草稿保存
- [ ] 輸入標題和內容
- [ ] 選擇 1-2 張圖片
- [ ] 選擇 1-2 個標籤
- [ ] 點擊 "保存草稿" 按鈕
- [ ] 驗證：顯示 "草稿已保存"
- [ ] 返回首頁
- [ ] 重新進入 CreatePost 頁面
- [ ] 驗證：之前的內容自動恢復

#### Test 5: 表單驗證
- [ ] 嘗試發布空標題
- [ ] 驗證：顯示 "請填寫標題和內容"
- [ ] 輸入標題但不輸入內容
- [ ] 驗證：顯示 "請填寫標題和內容"
- [ ] 輸入超長標籤（>20 字符）
- [ ] 驗證：顯示錯誤提示

### ✅ 評論功能測試

#### Test 6: 發表評論
- [ ] 打開任意文章詳情
- [ ] 點擊評論按鈕打開評論列表
- [ ] 輸入評論："這是一條測試評論"
- [ ] 點擊 "發布" 按鈕
- [ ] 驗證：評論出現在列表頂部
- [ ] 驗證：作者名稱和頭像正確顯示

#### Test 7: 點讚評論
- [ ] 點擊評論的愛心圖標
- [ ] 驗證：圖標變為實心紅色
- [ ] 驗證：點讚數 +1
- [ ] 再次點擊愛心圖標
- [ ] 驗證：圖標變回空心
- [ ] 驗證：點讚數 -1

#### Test 8: 回覆評論（第一層）
- [ ] 點擊評論下的 "回覆" 按鈕
- [ ] 驗證：輸入框上方顯示 "回覆 @用戶名"
- [ ] 驗證：placeholder 顯示 "回覆 @用戶名..."
- [ ] 輸入回覆內容："這是一條回覆"
- [ ] 點擊 "發布" 按鈕
- [ ] 驗證：回覆顯示在原評論下方
- [ ] 驗證：回覆有縮進（向右 20px）
- [ ] 驗證：顯示 "回覆 @原用戶名"

#### Test 9: 回覆的回覆（第二層）
- [ ] 點擊第一層回覆下的 "回覆" 按鈕
- [ ] 輸入內容："這是第二層回覆"
- [ ] 點擊 "發布" 按鈕
- [ ] 驗證：第二層回覆顯示
- [ ] 驗證：縮進更深（向右 40px）
- [ ] 驗證：顯示正確的回覆對象

#### Test 10: 第三層回覆（深度限制）
- [ ] 點擊第二層回覆下的 "回覆" 按鈕
- [ ] 輸入內容："這是第三層回覆"
- [ ] 點擊 "發布" 按鈕
- [ ] 驗證：第三層回覆顯示
- [ ] 驗證：縮進最深（向右 60px）
- [ ] 驗證：第三層回覆**沒有**回覆按鈕（達到深度限制）

#### Test 11: 取消回覆
- [ ] 點擊任意評論的 "回覆" 按鈕
- [ ] 驗證：顯示回覆指示器
- [ ] 點擊指示器上的 X 按鈕
- [ ] 驗證：回覆指示器消失
- [ ] 驗證：輸入框恢復為普通評論模式

#### Test 12: 加載更多評論
- [ ] 滾動到評論列表底部
- [ ] 驗證：自動加載更多評論
- [ ] 驗證：顯示加載指示器
- [ ] 驗證：新評論被添加到列表

#### Test 13: 評論長文本
- [ ] 輸入超過 500 字符的評論
- [ ] 驗證：輸入被限制在 500 字符
- [ ] 輸入接近 500 字符的評論
- [ ] 點擊發布
- [ ] 驗證：長評論正確顯示，有適當的行高

### ✅ 綜合測試場景

#### Test 14: 完整發布流程
1. [ ] 創建新文章
2. [ ] 添加 5 張圖片
3. [ ] 選擇 5 個標籤
4. [ ] 輸入標題和豐富內容
5. [ ] 保存草稿
6. [ ] 關閉應用
7. [ ] 重新打開應用
8. [ ] 進入 CreatePost
9. [ ] 驗證草稿恢復
10. [ ] 修改部分內容
11. [ ] 發布文章
12. [ ] 驗證文章出現在首頁

#### Test 15: 評論互動流程
1. [ ] 打開文章詳情
2. [ ] 發表 3 條頂層評論
3. [ ] 對第 1 條評論點讚
4. [ ] 回覆第 2 條評論
5. [ ] 對自己的回覆點讚
6. [ ] 回覆第 3 條評論
7. [ ] 對這個回覆再次回覆
8. [ ] 對第二層回覆再次回覆
9. [ ] 驗證：3 層嵌套正確顯示
10. [ ] 驗證：所有點讚狀態正確

#### Test 16: 草稿覆蓋測試
1. [ ] 創建文章 A（標題："文章 A"）
2. [ ] 保存草稿
3. [ ] 返回首頁
4. [ ] 創建文章 B（標題："文章 B"）
5. [ ] 保存草稿
6. [ ] 驗證：新草稿覆蓋舊草稿
7. [ ] 返回並重新打開
8. [ ] 驗證：只有文章 B 的草稿

## 視覺檢查

### UI 元素檢查
- [ ] 圖片預覽大小一致（100x100）
- [ ] 刪除按鈕位置正確（右上角）
- [ ] 標籤樣式統一
- [ ] 回覆縮進視覺清晰
- [ ] 按鈕禁用狀態可見
- [ ] 加載動畫流暢

### 響應式檢查
- [ ] 不同屏幕寬度下佈局正常
- [ ] 鍵盤彈出時內容可見
- [ ] 長文本不溢出
- [ ] 圖片自適應

### 主題適配檢查
- [ ] 切換到深色模式
- [ ] 驗證：所有顏色正確
- [ ] 驗證：文字可讀
- [ ] 驗證：按鈕顏色適配

## 錯誤處理測試

### Test 17: 網絡錯誤
- [ ] 斷開網絡連接
- [ ] 嘗試發布文章
- [ ] 驗證：顯示友好錯誤提示
- [ ] 恢復網絡
- [ ] 重試發布
- [ ] 驗證：發布成功

### Test 18: 權限拒絕
- [ ] 在設置中拒絕相冊權限
- [ ] 點擊 "添加圖片"
- [ ] 驗證：顯示權限提示
- [ ] 授予權限
- [ ] 重試
- [ ] 驗證：圖片選擇正常

## 性能測試

### Test 19: 大量評論加載
- [ ] 打開有大量評論的文章
- [ ] 快速滾動到底部
- [ ] 驗證：滾動流暢
- [ ] 驗證：評論逐步加載
- [ ] 驗證：無卡頓

### Test 20: 大量圖片處理
- [ ] 上傳 9 張高分辨率圖片
- [ ] 驗證：上傳過程流暢
- [ ] 驗證：預覽顯示正常
- [ ] 驗證：內存使用合理

## 測試結果記錄

| 測試編號 | 功能 | 狀態 | 備註 |
|---------|------|------|------|
| Test 1  | 基本文章創建 | ⬜ |  |
| Test 2  | 圖片上傳 | ⬜ |  |
| Test 3  | 標籤選擇 | ⬜ |  |
| Test 4  | 草稿保存 | ⬜ |  |
| Test 5  | 表單驗證 | ⬜ |  |
| Test 6  | 發表評論 | ⬜ |  |
| Test 7  | 點讚評論 | ⬜ |  |
| Test 8  | 回覆評論 | ⬜ |  |
| Test 9  | 回覆的回覆 | ⬜ |  |
| Test 10 | 深度限制 | ⬜ |  |
| Test 11 | 取消回覆 | ⬜ |  |
| Test 12 | 加載更多 | ⬜ |  |
| Test 13 | 長文本 | ⬜ |  |
| Test 14 | 完整流程 | ⬜ |  |
| Test 15 | 評論互動 | ⬜ |  |
| Test 16 | 草稿覆蓋 | ⬜ |  |
| Test 17 | 網絡錯誤 | ⬜ |  |
| Test 18 | 權限拒絕 | ⬜ |  |
| Test 19 | 大量評論 | ⬜ |  |
| Test 20 | 大量圖片 | ⬜ |  |

## 已知限制

1. **圖片上傳**
   - 當前只保存本地 URI，未上傳到服務器
   - 需要實現後端圖片上傳 API

2. **評論深度**
   - 最多 3 層嵌套
   - 超過 3 層不顯示回覆按鈕

3. **草稿系統**
   - 只保存一個草稿
   - 新草稿會覆蓋舊草稿

4. **Mock 數據**
   - 當前使用本地 mock 數據
   - 需要集成真實後端 API

## 下一步建議

完成所有測試後，根據測試結果：
1. 修復發現的 Bug
2. 優化用戶體驗問題
3. 集成後端 API
4. 添加圖片上傳功能
5. 實現評論編輯/刪除
6. 添加更多互動功能
